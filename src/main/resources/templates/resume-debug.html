<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Resume Optimizer - Debug</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container py-4">
  <h3>Resume Optimizer - Debug Version</h3>
  
  <!-- Always show debug info -->
  <div class="alert alert-info">
    <strong>Debug Info:</strong><br>
    Resume ID: <span th:text="${resumeId ?: 'null'}">null</span><br>
    ATS Original: <span th:text="${atsOriginal ?: 'null'}">null</span><br>
    ATS Optimized: <span th:text="${atsOptimized ?: 'null'}">null</span><br>
    Original Text Length: <span th:text="${originalText != null ? #strings.length(originalText) : 'null'}">null</span><br>
    Optimized Text Length: <span th:text="${optimizedText != null ? #strings.length(optimizedText) : 'null'}">null</span><br>
    Keywords Count: <span th:text="${injectedKeywords != null ? #lists.size(injectedKeywords) : 'null'}">null</span><br>
    Insights Count: <span th:text="${insights != null ? #lists.size(insights) : 'null'}">null</span><br>
  </div>
  
  <form method="post" action="/resume/optimize-debug" enctype="multipart/form-data" class="row g-3">
    <div class="col-md-6">
      <label class="form-label">Paste Resume Text</label>
      <textarea class="form-control" name="resumeText" rows="8" placeholder="Paste your resume text here..." required></textarea>
    </div>
    <div class="col-md-6">
      <label class="form-label">Target Job Description</label>
      <textarea class="form-control" name="jobDescription" rows="8" placeholder="Paste job description here..." required></textarea>
      <button class="btn btn-primary mt-3" type="submit">Optimize</button>
    </div>
  </form>

  <!-- Results Section -->
  <div class="mt-5" th:if="${resumeId != null}">
    <div class="alert alert-success">
      <h4>âœ… Optimization Complete!</h4>
      <p>Resume ID: <span th:text="${resumeId}">0</span></p>
      <p>Original Score: <span th:text="${atsOriginal}">0</span>%</p>
      <p>Optimized Score: <span th:text="${atsOptimized}">0</span>%</p>
    </div>
    
    <div class="row">
      <div class="col-md-6">
        <h5>Original Resume</h5>
        <div class="border p-3" style="max-height: 300px; overflow-y: auto;">
          <pre th:text="${originalText}">Original text</pre>
        </div>
      </div>
      <div class="col-md-6">
        <h5>Optimized Resume</h5>
        <div class="border p-3" style="max-height: 300px; overflow-y: auto;">
          <pre th:text="${optimizedText}">Optimized text</pre>
        </div>
      </div>
    </div>
  </div>
</div>
</body>
</html>